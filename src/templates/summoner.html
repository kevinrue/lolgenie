{% extends "base.html" %}


{% block content %}

{% if success["summoner_data"] %}
<h1>
  <span class="text-primary">{{summoner_data.name}}</span>
  <img
    src="http://ddragon.leagueoflegends.com/cdn/{{settings['latest_release']}}/img/profileicon/{{summoner_data['profileIconId']}}.png"
    width="50px"></img>
</h1>

<h2>General data</h2>
<ul>
  <li><b>Summoner level:</b> <span class="badge rounded-pill bg-success">{{summoner_data.summonerLevel}}</span></li>
  {% for league_data in summoner_league_data %}
  <li><b>Queue type:</b> {{league_data.queueType}}</li>
  <ul>
    <li><b>Tier:</b> {{league_data.tier}} {{league_data.rank}}</li>
    <li><b>League points (LP):</b> {{league_data.leaguePoints}}</li>
    <li><b>Win / Loss:</b> {{league_data.wins}} / {{league_data.losses}} ({{ league_data.wins_percent }} %) </li>
    {% if league_data.hotStreak %}
    <li><b>Hot streak!</b></li>
    {% endif %}
  </ul>
  {% endfor %}
</ul>
{% endif %}


<div class="row">
  {% if success["last_games"] %}
  <div class="col-7">
    <h2>Latest games</h2>
    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th>Game ID</th>
          <th>Champion</th>
          <th>Lane</th>
          <th>Time - Date</th>
        </tr>
      </thead>
      <tbody>
        {% for game in last_games['matches'] %}
        <tr>
          <td>{{game['gameId']}}</td>
          <td>
            <img
              src="http://ddragon.leagueoflegends.com/cdn/{{settings['latest_release']}}/img/champion/{{game['champion_name']}}.png"
              width="30px"></img>
            {{game['champion_name']}}
          </td>
          <td>
            {% if game['lane'] != "NONE" %}
            {{game['lane']}}
            {% endif %}
          </td>
          <td>
            {{game['datetime_readable']}}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div><!-- /col -->
  {% endif %}

  {% if plot and plot["most_played_champs"] %}
  <div class="col-5">
    <h2>Most played champions</h2>
    <canvas id="plot_most_played_champs"></canvas>

    <script type="text/javascript">
      var data = {{ plot.most_played_champs| tojson | safe}};
      var max_played = Math.max(...data.datasets[0].data);
    </script>

    <script type="text/javascript">
      var ctx = document.getElementById('plot_most_played_champs').getContext('2d');
      var config = {
        type: "bar",
        data: data,
        options: {
          responsive: true,
          legend: {
            position: 'bottom',
            display: false
          },
          title: {
            display: false,
            // text: 'Most played champions'
          },
          scales: {
            yAxes: [{
              ticks: {
                min: 0,
                stepSize: 1,
                max: max_played + 1
              }
            }]
          }
        }
      };
      var chart = new Chart(ctx, config);
    </script>

  </div><!-- /col -->
  {% endif %}



</div><!-- /row -->





<a href="{{url_for('home')}}">Go back to home</a>
{% endblock %}